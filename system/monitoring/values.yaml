kube-prometheus-stack:
  ## Deploy alertmanager
  alertmanager:
    enabled: true
    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
      hosts: ["alertmanager.labjoel.com"]
      tls: 
      - secretName: alertmanager-general-tls
        hosts:
        - alertmanager.labjoel.com

    # Setup persistent HA storage
    alertmanagerSpec:
      storage:
       volumeClaimTemplate:
         spec:
           storageClassName: longhorn
           accessModes: ["ReadWriteMany"]
           resources:
             requests:
               storage: 5Gi


  ## Using default values from https://github.com/grafana/helm-charts/blob/main/charts/grafana/values.yaml
  grafana:
    enabled: true
    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
      hosts: ["grafana.labjoel.com"]
      tls: 
      - secretName: grafana-general-tls
        hosts:
        - grafana.labjoel.com

    # Setup persistent HA storage
    persistence:
      enabled: true
      type: pvc
      storageClassName: longhorn
      accessModes:
        - ReadWriteMany
      size: 5Gi
      finalizers:
        - kubernetes.io/pvc-protection

  ## Deploy a Prometheus instance
  prometheus:
    enabled: true
    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
      hosts: ["prometheus.labjoel.com"]
      tls: 
      - secretName: prometheus-general-tls
        hosts:
        - prometheus.labjoel.com

    # Setup persistent HA storage
    prometheusSpec:
      storageSpec:
        volumeClaimTemplate:
          spec:
            storageClassName: longhorn
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 5Gi
